@{
    ViewData["Title"] = "Analyze Image";
}

<h2>Analyze Image</h2>
<form id="analyzeForm" enctype="multipart/form-data" method="post" action="/api/Files/analyze">
    <input type="file" name="file" accept="image/*" required />
    <button type="submit">Analyze Image</button>
</form>

<pre id="result"></pre>

<script>
    document.getElementById('analyzeForm').onsubmit = async function(e) {
        e.preventDefault();
        const form = e.target;
        const data = new FormData(form);
        const result = document.getElementById('result');
        result.textContent = 'Analyzing...';
        try {
            const response = await fetch(form.action, {
                method: 'POST',
                body: data
            });
            const json = await response.json();
            result.textContent = JSON.stringify(json, null, 2);
        } catch (err) {
            result.textContent = 'Error: ' + err;
        }
    };
</script>
